DROP TABLE "Crash_Locations";
DROP TABLE "airbnbs";
DROP TABLE "crime_data";

CREATE TABLE "airbnbs" (
    "id" int   NOT NULL,
    "neighbourhood" VARCHAR(66)   NOT NULL,
    "latitude" INT   NOT NULL,
    "longitude" INT   NOT NULL,
    "room_type" VARCHAR(66)   NOT NULL,
    "price" money   NOT NULL,
    CONSTRAINT "pk_airbnbs" PRIMARY KEY (
        "id"
     )
);

CREATE TABLE "Crash_Locations" (
    "number" int   NOT NULL,
    "accident_year" int   NOT NULL,
    "collision_date" varchar(30)   NOT NULL,
    "collision_time" int   NOT NULL,
    "Day_of_week" int   NOT NULL,
    "longitude" int   NOT NULL,
    "latitude" int   NOT NULL,
    CONSTRAINT "pk_Crash_Locations" PRIMARY KEY (
        "number"
     )
);

CREATE TABLE "crime_data" (
    "SORT_ORDER" INT,
    "Crime" TEXT,
    "ADAMS_NORTH" INT,
    "ALLIED_GARDENS" INT,
    "ALTA_VISTA" INT,
    "AZALEA_HOLLYWOOD_PARK" INT,
    "BALBOA_PARK" INT,
    "BARRIO_LOGAN" INT,
    "BAY_HO" INT,
    "BAY_PARK" INT,
    "BAY_TERRACES" INT,
    "BIRDLAND" INT,
    "BLACK_MOUNTAIN_RANCH" INT,
    "BORDER" INT,
    "BROADWAY_HEIGHTS" INT,
    "BURLINGAME" INT,
    "CARMEL_MOUNTAIN" INT,
    "CARMEL_VALLEY" INT,
    "CASTLE" INT,
    "CHEROKEE_POINT" INT,
    "CHOLLAS_CREEK" INT,
    "CHOLLAS_VIEW" INT,
    "CLAIREMONT_MESA_EAST" INT,
    "CLAIREMONT_MESA_WEST" INT,
    "COLINA_DEL_SOL" INT,
    "COLLEGE_AREA_EAST" INT,
    "COLLEGE_AREA_WEST" INT,
    "CORE_COLUMBIA" INT,
    "CORRIDOR" INT,
    "CORTEZ" INT,
    "DEL_CERRO" INT,
    "DEL_MAR_HEIGHTS" INT,
    "EAST_VILLAGE" INT,
    "EGGER_HIGHLANDS" INT,
    "EL_CERRITO" INT,
    "EMERALD_HILLS" INT,
    "ENCANTO" INT,
    "FAIRMOUNT_PARK" INT,
    "FAIRMOUNT_VILLAGE" INT,
    "FOX_CANYON" INT,
    "GASLAMP" INT,
    "GOLDEN_HILL" INT,
    "GRANT_HILL" INT,
    "GRANTVILLE" INT,
    "HARBORVIEW" INT,
    "HILLCREST" INT,
    "HORTON_PLAZA" INT,
    "ISLENAIR" INT,
    "JAMACHA_LOMITA" INT,
    "KEARNY_MESA" INT,
    "KENSINGTON" INT,
    "LA_JOLLA" INT,
    "LA_PLAYA" INT,
    "LAKE_MURRAY" INT,
    "LINCOLN_PARK" INT,
    "LINDA_VISTA" INT,
    "LITTLE_ITALY" INT,
    "LOGAN_HEIGHTS" INT,
    "LOMA_PORTAL" INT,
    "MARINA" INT,
    "MIDTOWN" INT,
    "MIDWAY_DISTRICT" INT,
    "MIRA_MESA" INT,
    "MIRAMAR" INT,
    "MIRAMAR_RANCH_NORTH" INT,
    "MISSION_BAY_PARK" INT,
    "MISSION_BEACH" INT,
    "MISSION_HILLS" INT,
    "MISSION_VALLEY_EAST" INT,
    "MISSION_VALLEY_WEST" INT,
    "MORENA" INT,
    "MOUNTAIN_VIEW" INT,
    "MT_HOPE" INT,
    "NESTOR" INT,
    "NORMAL_HEIGHTS" INT,
    "NORTH_CITY" INT,
    "NORTH_CLAIREMONT" INT,
    "NORTH_PARK" INT,
    "OAK_PARK" INT,
    "OCEAN_BEACH" INT,
    "OCEAN_CREST" INT,
    "OLD_TOWN" INT,
    "OTAY_MESA" INT,
    "OTAY_MESA_WEST" INT,
    "PACIFIC_BEACH" INT,
    "PALM_CITY" INT,
    "PARADISE_HILLS" INT,
    "PARK_WEST" INT,
    "PETCO_PARK" INT,
    "POINT_LOMA_HEIGHTS" INT,
    "QUALCOMM" INT,
    "RANCHO_BERNARDO" INT,
    "RANCHO_ENCANTADA" INT,
    "RANCHO_PENASQUITOS" INT,
    "REDWOOD_VILLAGE_ROLANDO_PARK" INT,
    "RIDGEVIEW_WEBSTER" INT,
    "ROLANDO" INT,
    "ROSEVILLE_FLEET_RIDGE" INT,
    "SABRE_SPRINGS" INT,
    "SAN_CARLOS" INT,
    "SAN_PASQUAL" INT,
    "SAN_YSIDRO" INT,
    "SCRIPPS_RANCH" INT,
    "SERRA_MESA" INT,
    "SHELLTOWN" INT,
    "SHERMAN_HEIGHTS" INT,
    "SKYLINE" INT,
    "SORRENTO_VALLEY" INT,
    "SOUTH_PARK" INT,
    "SOUTHCREST" INT,
    "STOCKTON" INT,
    "SUNSET_CLIFFS" INT,
    "SWAN_CANYON" INT,
    "TALMADGE" INT,
    "TERALTA_EAST" INT,
    "TERALTA_WEST" INT,
    "TIERRASANTA" INT,
    "TIJUANA_RIVER_VALLEY" INT,
    "TORREY_HIGHLANDS" INT,
    "TORREY_PINES" INT,
    "TORREY_PRESERVE" INT,
    "UNDEFINED" INT,
    "UNIVERSITY_CITY" INT,
    "UNIVERSITY_HEIGHTS" INT,
    "VALENCIA_PARK" INT,
    "WOODED_AREA" INT,
    "Total" INT
);


ALTER TABLE "airbnbs"
ADD CONSTRAINT "unique_airbnbs_id_longitude_latitude" UNIQUE ("id", "longitude", "latitude");


UPDATE "Crash_Locations"
SET "collision_date" = '1742-01-01'::DATE;

ALTER TABLE "airbnbs"
ALTER COLUMN "latitude" TYPE NUMERIC(10, 6);
ALTER TABLE "airbnbs"
ALTER COLUMN "longitude" TYPE NUMERIC(10, 6);
ALTER TABLE "airbnbs"
ALTER COLUMN "price" TYPE NUMERIC(10, 2);

ALTER TABLE "Crash_Locations"
ALTER COLUMN "longitude" TYPE NUMERIC(10, 6);
ALTER TABLE "Crash_Locations"
ALTER COLUMN "latitude" TYPE NUMERIC(10, 6); 


SELECT * FROM "Crash_Locations"
SELECT * FROM "airbnbs"
SELECT * FROM "crime_data"